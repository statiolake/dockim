# ユーザーガイド

このユーザーガイドは、Dockim の日常的なワークフローとコア機能をカバーしています。[はじめよう](../getting-started.md)の章を完了した後、このガイドを使って日々の開発ワークフローをマスターし、Dockim で生産性を向上させることができます。

## 概要

ユーザーガイドは3つの主要セクションに分かれています：

- **[プロジェクトの初期化](project-initialization.md)** - 新しいプロジェクトのセットアップと生成されるファイルの理解
- **[コンテナ管理](container-management.md)** - 開発コンテナのビルド、開始、停止、メンテナンス
- **[開発ワークフロー](development-workflow.md)** - コンテナ内での日々の開発活動

## コア概念

具体的なワークフローに入る前に、Dockim の動作を理解するのに役立つコア概念を確立しましょう：

### 開発コンテナ

開発コンテナ（または「dev container」）は、完全な機能を備えた開発環境として機能する実行中の Docker コンテナです。以下を含みます：

- **ランタイム環境**: 必要なプログラミング言語、フレームワーク、ツール
- **ソースコードアクセス**: プロジェクトファイルがコンテナにマウントされる
- **分離**: 依存関係がホストシステムと競合しない
- **再現性**: すべてのチームメンバーが同じ環境を取得

### Dockim の役割

Dockim は、あなたと基盤のコンテナ技術の間の親しみやすいインターフェースとして機能します：

```
あなた → Dockim → Dev Container CLI → Docker → 開発環境
```

この抽象化により、コンテナ管理の詳細よりも開発に集中できます。

### プロジェクト構造

すべての Dockim プロジェクトは以下の構造に従います：

```
your-project/
├── .devcontainer/          # コンテナ設定
│   ├── devcontainer.json  # メイン設定ファイル
│   ├── compose.yml         # Docker Compose セットアップ
│   └── Dockerfile          # カスタムイメージ定義
├── src/                    # アプリケーションコード
└── ... （その他のプロジェクトファイル）
```

### 設定階層

Dockim は、グローバルな設定とプロジェクト固有の設定の両方を可能にする設定階層を使用します：

1. **グローバル設定** (`~/.config/dockim/config.toml`) - 個人のデフォルト
2. **プロジェクト設定** (`.devcontainer/devcontainer.json`) - プロジェクト固有の設定
3. **コマンドオプション** - 特定の操作のランタイム上書き

## 一般的なワークフロー

Dockim で使用する最も一般的なワークフローは以下のとおりです：

### 新しい日を始める

```bash
# プロジェクトに移動
cd my-project

# 開発環境を開始
dockim up

# エディタを起動
dockim neovim
```

### コンテナセットアップを変更する

```bash
# コンテナ設定を編集
vim .devcontainer/Dockerfile

# 変更を反映してリビルド
dockim build --rebuild

# 新しいコンテナで再起動
dockim up
```

### プロジェクト間の切り替え

```bash
# 現在のプロジェクトを停止
dockim stop

# 他のプロジェクトに切り替え
cd ../other-project

# 他のプロジェクトを開始
dockim up
```

### 一日の終わりのクリーンアップ

```bash
# コンテナを停止（素早く再起動するために保持）
dockim stop

# またはコンテナを完全に削除（ディスク容量を解放）
dockim down
```

## コンテナの状態について

開発コンテナは以下のいくつかの状態になることができます：

- **未作成**: まだコンテナが存在しない（初期状態）
- **ビルド済み**: コンテナイメージは存在するが実行中のコンテナはない
- **実行中**: コンテナがアクティブに動作し開発準備完了
- **停止中**: コンテナは存在するが動作していない
- **削除済み**: コンテナが削除された（ただしイメージは残る可能性）

Dockim コマンドがこれらの状態にどう影響するかは以下のとおりです：

```
未作成 → dockim build → ビルド済み
ビルド済み → dockim up → 実行中
実行中 → dockim stop → 停止中
停止中 → dockim up → 実行中
停止中 → dockim down → 削除済み（ビルド済みに戻る）
```

## ベストプラクティス

### プロジェクトの整理

- すべてのプロジェクト固有の設定を `.devcontainer/` に保持
- バージョン管理を使用してコンテナ設定の変更を追跡
- プロジェクトの README で手動セットアップ手順を文書化

### コンテナのメンテナンス

- セキュリティ更新を取得するため定期的にコンテナをリビルド：`dockim build --rebuild`
- 未使用のコンテナをクリーンアップするため定期的に `dockim down` を使用
- 特に複数のプロジェクトで作業するときはディスク使用量を監視

### 開発ワークフロー

- 作業開始前にコンテナを開始：`dockim up`
- 素早いコマンドライン作業には `dockim shell` を使用
- 長時間の編集セッションには `dockim neovim` を使用
- プロジェクト切り替え時にコンテナを停止：`dockim stop`

### チーム協業

- バージョン管理を通じて `.devcontainer/` 設定を共有
- 必要な環境変数やシークレットを文書化
- チーム全体で一貫したベースイメージとツールバージョンを使用
- カスタムイメージには共有コンテナレジストリの使用を検討

## 次のステップ

コア概念を理解したので、Dockim の使用の特定の側面について詳しく学んでください：

1. **[プロジェクトの初期化](project-initialization.md)** - 新しいプロジェクトを効果的にセットアップする方法
2. **[コンテナ管理](container-management.md)** - コンテナのビルドと管理をマスターする
3. **[開発ワークフロー](development-workflow.md)** - 日々の開発ルーチンを最適化する

各セクションはこれらのコア概念を基に構築され、具体的なシナリオに対する実用的で実行可能なガイダンスを提供します。